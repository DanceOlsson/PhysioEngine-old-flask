{% extends "base.html" %}

{% block title %}KOOS Frågeformulär{% endblock %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/questionnaires/styles.css') }}">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
{% endblock %}

{% block content %}
    <div class="container my-5 koos-form">
        <h1 class="mb-4 text-center">KOOS Frågeformulär</h1>

        <!-- Initial Instructions -->
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">Instruktioner</h5>
                <p class="card-text instructions section-instructions">
                    Detta formulär innehåller frågor om hur du ser på ditt knä. Informationen ska hjälpa till att följa hur du mår och fungerar i ditt dagliga liv.
                </p>
                <p class="card-text instructions section-instructions">
                    Besvara frågorna genom att kryssa för det alternativ du tycker stämmer bäst in på dig (ett alternativ för varje fråga). Om du är osäker, kryssa ändå för det alternativ som känns riktigast.
                </p>
                <p class="card-text instructions section-instructions">
                    <strong>Symptom:</strong><br>
                    Tänk på de symptom Du haft från ditt knä under den senaste veckan när Du besvarar dessa frågor.
                </p>
            </div>
        </div>

        <form method="POST" action="{{ url_for('patient_form', session_id=session_id, evaluation_form='koos') }}">
            {% for question in questions %}

                <!-- Display specific instructions before certain questions -->
                {% if question.id == 'S6' %}
                    <div class="mb-4">
                        <h2 class="section-heading">Stelhet</h2>
                        <p class="section-instructions">
                            Följande frågor rör ledstelhet. Ledstelhet innebär svårighet att komma igång eller ökat motstånd då Du böjer eller sträcker i knät. Markera graden av ledstelhet Du har upplevt i ditt knä den senaste veckan.
                        </p>
                    </div>
                {% elif question.id == 'P1' %}
                    <div class="mb-4">
                        <h2 class="section-heading">Smärta</h2>
                    </div>
                {% elif question.id == 'P2' %}
                    <div class="mb-4">
                        <p class="section-instructions">
                            Vilken grad av smärta har Du känt i ditt knä den senaste veckan under följande aktiviteter?
                        </p>
                    </div>
                {% elif question.id == 'A1' %}
                    <div class="mb-4">
                        <h2 class="section-heading">Funktion, dagliga livet</h2>
                        <p class="section-instructions">
                            Följande frågor rör din fysiska förmåga. Ange graden av svårighet du upplevt den senaste veckan vid följande aktiviteter på grund av dina knäbesvär.
                        </p>
                    </div>
                {% elif question.id == 'A4' %}
                    <div class="mb-4">
                        <p class="section-instructions">
                            Ange graden av svårighet du upplevt med varje aktivitet den senaste veckan.
                        </p>
                    </div>
                {% elif question.id == 'SP1' %}
                    <div class="mb-4">
                        <h2 class="section-heading">Funktion, fritid och idrott</h2>
                        <p class="section-instructions">
                            Följande frågor rör din fysiska förmåga. Ange graden av svårighet du upplevt den senaste veckan vid följande aktiviteter på grund av dina knäbesvär.
                        </p>
                    </div>
                {% elif question.id == 'Q1' %}
                    <div class="mb-4">
                        <h2 class="section-heading">Livskvalité</h2>
                    </div>
                {% endif %}

                <!-- Display the question with horizontal radio buttons -->
                <div class="question mb-4">
                    <label class="form-label">{{ loop.index }}. {{ question.text }}</label>
                    <div class="btn-group d-flex flex-row" role="group" aria-label="Answer Options">
                        {% for option in question.options %}
                            <input type="radio" class="btn-check" name="question_{{ question.id }}" id="question_{{ question.id }}_{{ option.value }}" value="{{ option.value }}" required>
                            <label class="btn answer-btn" for="question_{{ question.id }}_{{ option.value }}" data-color="{{ loop.index }}"> {{ option.text }} </label>
                        {% endfor %}
                    </div>
                </div>

            {% endfor %}
            <div class="text-center mt-4">
                <button type="submit" class="btn btn-primary btn-lg">Skicka in</button>
            </div>
        </form>
    </div>
{% endblock %}
